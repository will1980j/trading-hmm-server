// crédit: © LuxAlgo for the session script
// modif by roam1
//@version=5
indicator("AMDX Time Zone - WJ (Auto DST)", overlay          = true, max_bars_back    = 500, max_lines_count  = 500, max_boxes_count  = 500, max_labels_count = 500)

//------------------------------------------------------------------------------
//Settings
//-----------------------------------------------------------------------------{
//Session A
show_sesa = input(false, '', inline = 'sesa', group = 'Session A')
sesa_txt = input('New York', '', inline = 'sesa', group = 'Session A')
sesa_ses = input.session('1300-2200', '', inline = 'sesa', group = 'Session A')
sesa_css = input.color(#ff5d00, '', inline = 'sesa', group = 'Session A')
sesa_range = input(true, 'Range', inline = 'sesa_overlays', group = 'Session A')

// NY AM Sessions
show_sesaamQ1 = input(true, '', inline = 'sesaamQ1', group = 'Session AM')
sesaamQ1_txt = input('New York AM Q1', '', inline = 'sesaamQ1', group = 'Session A')
sesaam_Q1_ses = input.session('0600-0730', '', inline = 'sesaamQ1', group = 'Session AM')
sesaamQ1_css = input.color(#ff5d00, '', inline = 'sesaamQ1', group = 'Session AM')
sesaamQ1_range = input(true, 'Range', inline = 'sesaamQ1_overlays', group = 'Session AM')

show_sesaamQ2 = input(true, '', inline = 'sesaamQ2', group = 'Session AM')
sesaamQ2_txt = input('New York AM Q2', '', inline = 'sesaamQ2', group = 'Session AM')
sesaam_Q2_ses = input.session('0730-0900', '', inline = 'sesaamQ2', group = 'Session AM')
sesaamQ2_css = input.color(#ff5d00, '', inline = 'sesaamQ2', group = 'Session AM')
sesaamQ2_range = input(true, 'Range', inline = 'sesaamQ2_overlays', group = 'Session AM')

sesaamQ3_txt = input('New York AM Q3', '', inline = 'sesaamQ3', group = 'Session AM')
show_sesaamQ3 = input(true, '', inline = 'sesaamQ3', group = 'Session AM')
sesaam_Q3_ses = input.session('0900-1030', '', inline = 'sesaamQ3', group = 'Session AM')
sesaamQ3_css = input.color(#ff5d00, '', inline = 'sesaamQ3', group = 'Session AM')
sesaamQ3_range = input(true, 'Range', inline = 'sesaamQ3_overlays', group = 'Session AM')

show_sesaamQ4 = input(true, '', inline = 'sesaamQ4', group = 'Session AM')
sesaamQ4_txt = input('New York AM Q4', '', inline = 'sesaamQ4', group = 'Session AM')
sesaam_Q4_ses = input.session('1030-1200', '', inline = 'sesaamQ4', group = 'Session AM')
sesaamQ4_css = input.color(#ff5d00, '', inline = 'sesaamQ4', group = 'Session AM')
sesaamQ4_range = input(true, 'Range', inline = 'sesaamQ4_overlays', group = 'Session AM')

// NY PM Sessions
show_sesapmQ1 = input(true, '', inline = 'sesapmQ1', group = 'Session PM')
sesapmQ1_txt = input('New York PM Q1', '', inline = 'sesapmQ1', group = 'Session PM')
sesapm_Q1_ses = input.session('1200-1330', '', inline = 'sesapmQ1', group = 'Session PM')
sesapmQ1_css = input.color(#ff5d00, '', inline = 'sesapmQ1', group = 'Session PM')
sesapmQ1_range = input(true, 'Range', inline = 'sesapmQ1_overlays', group = 'Session PM')

show_sesapmQ2 = input(true, '', inline = 'sesapmQ2', group = 'Session PM')
sesapmQ2_txt = input('New York PM Q2', '', inline = 'sesapmQ2', group = 'Session PM')
sesapm_Q2_ses = input.session('1330-1500', '', inline = 'sesapmQ2', group = 'Session PM')
sesapmQ2_css = input.color(#ff5d00, '', inline = 'sesapmQ2', group = 'Session PM')
sesapmQ2_range = input(true, 'Range', inline = 'sesapmQ2_overlays', group = 'Session PM')

show_sesapmQ3 = input(true, '', inline = 'sesapmQ3', group = 'Session PM')
sesapmQ3_txt = input('New York PM Q3', '', inline = 'sesapmQ3', group = 'Session PM')
sesapm_Q3_ses = input.session('1500-1630', '', inline = 'sesapmQ3', group = 'Session PM')
sesapmQ3_css = input.color(#ff5d00, '', inline = 'sesapmQ3', group = 'Session PM')
sesapmQ3_range = input(true, 'Range', inline = 'sesapmQ3_overlays', group = 'Session PM')

show_sesapmQ4 = input(true, '', inline = 'sesapmQ4', group = 'Session PM')
sesapmQ4_txt = input('New York PM Q4', '', inline = 'sesapmQ4', group = 'Session PM')
sesapm_Q4_ses = input.session('1630-1800', '', inline = 'sesapmQ4', group = 'Session PM')
sesapmQ4_css = input.color(#ff5d00, '', inline = 'sesapmQ4', group = 'Session PM')
sesapmQ4_range = input(true, 'Range', inline = 'sesapmQ4_overlays', group = 'Session PM')

//Session B London
show_sesb = input(false, '', inline = 'sesb', group = 'Session B')
sesb_txt = input('London', '', inline = 'sesb', group = 'Session B')
sesb_ses = input.session('0000-0600', '', inline = 'sesb', group = 'Session B')
sesb_css = input.color(#2157f3, '', inline = 'sesb', group = 'Session B')
sesb_range = input(true, 'Range', inline = 'sesb_overlays', group = 'Session B')

// London Q Sessions
show_sesbQ1 = input(true, '', inline = 'sesbQ1', group = 'Session B')
sesbQ1_txt = input('London Q1', '', inline = 'sesbQ1', group = 'Session B')
sesb_Q1_ses = input.session('0000-0130', '', inline = 'sesbQ1', group = 'Session B')
sesbQ1_css = input.color(#00c9c9, '', inline = 'sesbQ1', group = 'Session B')
sesbQ1_range = input(true, 'Range', inline = 'sesbQ1_overlays', group = 'Session B')

show_sesbQ2 = input(true, '', inline = 'sesbQ2', group = 'Session B')
sesbQ2_txt = input('London Q2', '', inline = 'sesbQ2', group = 'Session B')
sesb_Q2_ses = input.session('0130-0300', '', inline = 'sesbQ2', group = 'Session B')
sesbQ2_css = input.color(#00c9c9, '', inline = 'sesbQ2', group = 'Session B')
sesbQ2_range = input(true, 'Range', inline = 'sesbQ2_overlays', group = 'Session B')

show_sesbQ3 = input(true, '', inline = 'sesbQ3', group = 'Session B')
sesbQ3_txt = input('London Q3', '', inline = 'sesbQ3', group = 'Session B')
sesb_Q3_ses = input.session('0300-0430', '', inline = 'sesbQ3', group = 'Session B')
sesbQ3_css = input.color(#00c9c9, '', inline = 'sesbQ3', group = 'Session B')
sesbQ3_range = input(true, 'Range', inline = 'sesbQ3_overlays', group = 'Session B')

show_sesbQ4 = input(true, '', inline = 'sesbQ4', group = 'Session B')
sesbQ4_txt = input('London Q4', '', inline = 'sesbQ4', group = 'Session B')
sesb_Q4_ses = input.session('0430-0600', '', inline = 'sesbQ4', group = 'Session B')
sesbQ4_css = input.color(#00c9c9, '', inline = 'sesbQ4', group = 'Session B')
sesbQ4_range = input(true, 'Range', inline = 'sesbQ4_overlays', group = 'Session B')

//Session C Tokyo
show_sesc = input(false, '', inline = 'sesc', group = 'Session C')
sesc_txt = input('Tokyo', '', inline = 'sesc', group = 'Session C')
sesc_ses = input.session('1800-2400', '', inline = 'sesc', group = 'Session C')
sesc_css = input.color(#e91e63, '', inline = 'sesc', group = 'Session C')
sesc_range = input(true, 'Range', inline = 'sesc_overlays', group = 'Session C')

//Asian Q Sessions
show_sescQ1 = input(true, '', inline = 'sescQ1', group = 'Session C')
sescQ1_txt = input('Tokyo Q1', '', inline = 'sescQ1', group = 'Session C')
sesc_Q1_ses = input.session('1800-1930', '', inline = 'sescQ1', group = 'Session C')
sescQ1_css = input.color(#e91e63, '', inline = 'sescQ1', group = 'Session C')
sescQ1_range = input(true, 'Range', inline = 'sescQ1_overlays', group = 'Session C')

show_sescQ2 = input(true, '', inline = 'sescQ2', group = 'Session C')
sescQ2_txt = input('Tokyo Q2', '', inline = 'sescQ2', group = 'Session C')
sesc_Q2_ses = input.session('1930-2100', '', inline = 'sescQ2', group = 'Session C')
sescQ2_css = input.color(#e91e63, '', inline = 'sescQ2', group = 'Session C')
sescQ2_range = input(true, 'Range', inline = 'sescQ2_overlays', group = 'Session C')

show_sescQ3 = input(true, '', inline = 'sescQ3', group = 'Session C')
sescQ3_txt = input('Tokyo Q3', '', inline = 'sescQ3', group = 'Session C')
sesc_Q3_ses = input.session('2100-2230', '', inline = 'sescQ3', group = 'Session C')
sescQ3_css = input.color(#e91e63, '', inline = 'sescQ3', group = 'Session C')
sescQ3_range = input(true, 'Range', inline = 'sescQ3_overlays', group = 'Session C')

show_sescQ4 = input(true, '', inline = 'sescQ4', group = 'Session C')
sescQ4_txt = input('Tokyo Q4', '', inline = 'sescQ4', group = 'Session C')
sesc_Q4_ses = input.session('2230-2400', '', inline = 'sescQ4', group = 'Session C')
sescQ4_css = input.color(#e91e63, '', inline = 'sescQ4', group = 'Session C')
sescQ4_range = input(true, 'Range', inline = 'sescQ4_overlays', group = 'Session C')

//Session D
show_sesd = input(false, '', inline = 'sesd', group = 'Session D')
sesd_txt = input('Sydney', '', inline = 'sesd', group = 'Session D')
sesd_ses = input.session('2100-0600', '', inline = 'sesd', group = 'Session D')
sesd_css = input.color(#ffeb3b, '', inline = 'sesd', group = 'Session D')
sesd_range = input(true, 'Range', inline = 'sesd_overlays', group = 'Session D')

//Timezones - AUTO DST DETECTION
use_auto_dst = input(true, 'Auto Eastern Time (Handles DST)', group = 'Timezone')
manual_offset = input.int(-5, 'Manual UTC Offset', group = 'Timezone')

//Ranges Options
bg_transp = input.float(90, 'Range Area Transparency', group = 'Ranges Settings')
show_outline = input(true, 'Range Outline', group = 'Ranges Settings')
show_txt = input(true, 'Range Label', group = 'Ranges Settings')

//Dashboard
show_dash = input(true, 'Show Dashboard', group   = 'Dashboard')
advanced_dash = input(true, 'Advanced Dashboard', group = 'Dashboard')
dash_loc = input.string('Top Right', 'Dashboard Location', options = ['Top Right', 'Bottom Right', 'Bottom Left'], group   = 'Dashboard')
text_size = input.string('Small', 'Dashboard Size', options = ['Tiny', 'Small', 'Normal'], group   = 'Dashboard')

//Dividers
show_ses_div = input(true, 'Show Sessions Divider', group = 'Dividers')
show_day_div = input(true, 'Show Daily Divider', group = 'Dividers')

//-----------------------------------------------------------------------------}
//Functions
//-----------------------------------------------------------------------------{
n = bar_index

//Get session average
get_avg(session)=>
    var len = 1
    var float csma = na
    var float sma = na
    
    if session > session[1]
        len := 1
        csma := close
    
    if session and session == session[1]
        len += 1    
        csma += close
    
    sma := csma / len
    sma

//Get trendline coordinates
get_linreg(session)=>
    var len = 1
    var float cwma  = na
    var float csma  = na
    var float csma2 = na
    var float y1 = na
    var float y2 = na
    var float stdev = na 
    var float r2    = na 
    
    if session > session[1]
        len   := 1
        cwma  := close
        csma  := close
        csma2 := close * close
    
    if session and session == session[1]
        len   += 1    
        csma  += close
        csma2 += close * close
        cwma  += close * len
    
    sma = csma / len
    wma = cwma / (len * (len + 1) / 2)
    cov   = (wma - sma) * (len+1)/2
    stdev := math.sqrt(csma2 / len - sma * sma)
    r2    := cov / (stdev * (math.sqrt(len*len - 1) / (2 * math.sqrt(3))))
    
    y1 := 4 * sma - 3 * wma
    y2 := 3 * wma - 2 * sma
    
    [y1 , y2, stdev, r2]

//Set line
set_line(session, y1, y2, session_css)=>
    var line tl = na
    
    if session > session[1]
        tl := line.new(n, close, n, close, color = session_css)
    
    if session and session == session[1]
        line.set_y1(tl, y1)
        line.set_xy2(tl, n, y2)

//Set session range
get_range(session, session_name, session_css)=>
    var t = 0 
    var max = high
    var min = low
    var box bx = na
    var label lbl = na 
    
    if session > session[1]
        t := time
        max := high
        min := low
        bx := box.new(n, max, n, min, bgcolor = color.new(session_css, bg_transp), border_color = show_outline ? session_css : na, border_style = line.style_dotted)
        
        if show_txt
            lbl := label.new(t, max, session_name, xloc = xloc.bar_time, textcolor = session_css, style = label.style_label_down, color = color.new(color.white, 100), size = size.tiny)
    
    if session and session == session[1]
        max := math.max(high, max)
        min := math.min(low, min)
        box.set_top(bx, max)
        box.set_rightbottom(bx, n, min)
        
        if show_txt
            label.set_xy(lbl, int(math.avg(t, time)), max)

//-----------------------------------------------------------------------------}
//Sessions
//-----------------------------------------------------------------------------{
tf = timeframe.period

// AUTO DST DETECTION - Automatically switches between UTC-4 (EDT) and UTC-5 (EST)
// Compare NY time to UTC to detect current offset
ny_time_check = time("1D", "America/New_York")
utc_time_check = time("1D", "UTC")
// If NY is 4 hours behind UTC, we're in EDT; if 5 hours behind, we're in EST
is_edt = (utc_time_check - ny_time_check) == (4 * 60 * 60 * 1000)
auto_offset = is_edt ? -4 : -5
final_offset = use_auto_dst ? auto_offset : manual_offset

var tz = str.format('UTC{0}{1}', final_offset >= 0 ? '+' : '-', math.abs(final_offset))

is_sesa = math.sign(nz(time(tf, sesa_ses, tz)))
is_sesaamQ1 = math.sign(nz(time(tf, sesaam_Q1_ses, tz)))
is_sesaamQ2 = math.sign(nz(time(tf, sesaam_Q2_ses, tz)))
is_sesaamQ3 = math.sign(nz(time(tf, sesaam_Q3_ses, tz)))
is_sesaamQ4 = math.sign(nz(time(tf, sesaam_Q4_ses, tz)))
is_sesapmQ1 = math.sign(nz(time(tf, sesapm_Q1_ses, tz)))
is_sesapmQ2 = math.sign(nz(time(tf, sesapm_Q2_ses, tz)))
is_sesapmQ3 = math.sign(nz(time(tf, sesapm_Q3_ses, tz)))
is_sesapmQ4 = math.sign(nz(time(tf, sesapm_Q4_ses, tz)))
is_sesb = math.sign(nz(time(tf, sesb_ses, tz)))
is_sesbQ1 = math.sign(nz(time(tf, sesb_Q1_ses, tz)))
is_sesbQ2 = math.sign(nz(time(tf, sesb_Q2_ses, tz)))
is_sesbQ3 = math.sign(nz(time(tf, sesb_Q3_ses, tz)))
is_sesbQ4 = math.sign(nz(time(tf, sesb_Q4_ses, tz)))
is_sesc = math.sign(nz(time(tf, sesc_ses, tz)))
is_sescQ1 = math.sign(nz(time(tf, sesc_Q1_ses, tz)))
is_sescQ2 = math.sign(nz(time(tf, sesc_Q2_ses, tz)))
is_sescQ3 = math.sign(nz(time(tf, sesc_Q3_ses, tz)))
is_sescQ4 = math.sign(nz(time(tf, sesc_Q4_ses, tz)))
is_sesd = math.sign(nz(time(tf, sesd_ses, tz)))

//-----------------------------------------------------------------------------}
//Dashboard
//-----------------------------------------------------------------------------{
var table_position = dash_loc == 'Bottom Left' ? position.bottom_left : dash_loc == 'Top Right' ? position.top_right : position.bottom_right
var table_size = text_size == 'Tiny' ? size.tiny : text_size == 'Small' ? size.small : size.normal
var tb = table.new(table_position, 5, 6, bgcolor = #1e222d, border_color = #373a46, border_width = 1, frame_color = #373a46, frame_width = 1)

if barstate.isfirst and show_dash
    table.cell(tb, 0, 0, 'LuxAlgo Modif by Roam1', text_color = color.white, text_size = table_size)
    table.merge_cells(tb, 0, 0, 1, 0)
    
    table.cell(tb, 0, 2, sesa_txt, text_color = sesa_css, text_size = table_size)
    table.cell(tb, 0, 3, sesb_txt, text_color = sesb_css, text_size = table_size)
    table.cell(tb, 0, 4, sesc_txt, text_color = sesc_css, text_size = table_size)
    table.cell(tb, 0, 5, sesd_txt, text_color = sesd_css, text_size = table_size)
    
    if advanced_dash
        table.cell(tb, 0, 1, 'Session', text_color = color.white, text_size = table_size)
        table.cell(tb, 1, 1, 'Status', text_color = color.white, text_size = table_size)

if barstate.islast and show_dash
    table.cell(tb, 1, 2, is_sesa ? 'Active' : 'Innactive', bgcolor = is_sesa ? #089981 : #f23645, text_color = color.white, text_size = table_size)
    table.cell(tb, 1, 3, is_sesb ? 'Active' : 'Innactive', bgcolor = is_sesb ? #089981 : #f23645, text_color = color.white, text_size = table_size)
    table.cell(tb, 1, 4, is_sesc ? 'Active' : 'Innactive', bgcolor = is_sesc ? #089981 : #f23645, text_color = color.white, text_size = table_size)
    table.cell(tb, 1, 5, is_sesd ? 'Active' : 'Innactive', bgcolor = is_sesd ? #089981 : #f23645, text_color = color.white, text_size = table_size)

//-----------------------------------------------------------------------------}
//Overlays
//-----------------------------------------------------------------------------{
//Ranges
if show_sesa and sesa_range
    get_range(is_sesa, sesa_txt, sesa_css)

if show_sesaamQ1 and sesaamQ1_range
    get_range(is_sesaamQ1, sesaamQ1_txt, sesaamQ1_css)

if show_sesaamQ2 and sesaamQ2_range
    get_range(is_sesaamQ2, sesaamQ2_txt, sesaamQ2_css)

if show_sesaamQ3 and sesaamQ3_range
    get_range(is_sesaamQ3, sesaamQ3_txt, sesaamQ3_css)

if show_sesaamQ4 and sesaamQ4_range
    get_range(is_sesaamQ4, sesaamQ4_txt, sesaamQ4_css)

if show_sesapmQ1 and sesapmQ1_range
    get_range(is_sesapmQ1, sesapmQ1_txt, sesapmQ1_css)

if show_sesapmQ2 and sesapmQ2_range
    get_range(is_sesapmQ2, sesapmQ2_txt, sesapmQ2_css)

if show_sesapmQ3 and sesapmQ3_range
    get_range(is_sesapmQ3, sesapmQ3_txt, sesapmQ3_css)

if show_sesapmQ4 and sesapmQ4_range
    get_range(is_sesapmQ4, sesapmQ4_txt, sesapmQ4_css)

if show_sesb and sesb_range
    get_range(is_sesb, sesb_txt, sesb_css)

if show_sesbQ1 and sesbQ1_range
    get_range(is_sesbQ1, sesbQ1_txt, sesbQ1_css)

if show_sesbQ2 and sesbQ2_range
    get_range(is_sesbQ2, sesbQ2_txt, sesbQ2_css)

if show_sesbQ3 and sesbQ3_range
    get_range(is_sesbQ3, sesbQ3_txt, sesbQ3_css)

if show_sesbQ4 and sesbQ4_range
    get_range(is_sesbQ4, sesbQ4_txt, sesbQ4_css)

if show_sesc and sesc_range
    get_range(is_sesc, sesc_txt, sesc_css)

if show_sescQ1 and sescQ1_range
    get_range(is_sescQ1, sescQ1_txt, sescQ1_css)

if show_sescQ2 and sescQ2_range
    get_range(is_sescQ2, sescQ2_txt, sescQ2_css)

if show_sescQ3 and sescQ3_range
    get_range(is_sescQ3, sescQ3_txt, sescQ3_css)

if show_sescQ4 and sescQ4_range
    get_range(is_sescQ4, sescQ4_txt, sescQ4_css)

if show_sesd and sesd_range
    get_range(is_sesd, sesd_txt, sesd_css)

//-----------------------------------------------------------------------------}
//Plots session dividers
//-----------------------------------------------------------------------------{
//Plot Divider A
plotshape(is_sesa and show_ses_div and show_sesa, "·", shape.square, location.bottom, na, text = ".", textcolor = sesa_css, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(is_sesa != is_sesa[1] and show_ses_div and show_sesa, "NYE", shape.labelup, location.bottom, na, text = "❚", textcolor = sesa_css, size = size.tiny, display = display.all - display.status_line, editable = false)

//Plot Divider B
plotshape(is_sesb and show_ses_div and show_sesb, "·", shape.labelup, location.bottom, na, text = ".", textcolor = sesb_css, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(is_sesb != is_sesb[1] and show_ses_div and show_sesb, "LDN", shape.labelup, location.bottom, na, text = "❚", textcolor = sesb_css, size = size.tiny, display = display.all - display.status_line, editable = false)

//Plot Divider C
plotshape(is_sesc and show_ses_div and show_sesc, "·", shape.square, location.bottom, na, text = ".", textcolor = sesc_css, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(is_sesc != is_sesc[1] and show_ses_div and show_sesc, "TYO", shape.labelup, location.bottom, na, text = "❚", textcolor = sesc_css, size = size.tiny, display = display.all - display.status_line, editable = false)

//Plot Divider D
plotshape(is_sesd and show_ses_div and show_sesd, "·", shape.labelup, location.bottom, na, text = ".", textcolor = sesd_css, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(is_sesd != is_sesd[1] and show_ses_div and show_sesd, "SYD", shape.labelup, location.bottom, na, text = "❚", textcolor = sesd_css, size = size.tiny, display = display.all - display.status_line, editable = false)

//-----------------------------------------------------------------------------}
//Plots daily dividers
//-----------------------------------------------------------------------------{
day = dayofweek

if day != day[1] and show_day_div
    line.new(n, close + syminfo.mintick, n, close - syminfo.mintick, color  = color.gray, extend = extend.both, style  = line.style_dashed)

plotshape(day != day[1] and day == 1 and show_day_div, "Sunday", shape.labeldown, location.top, na, text = "Sunday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 2 and show_day_div, "Monday", shape.labeldown, location.top, na, text = "Monday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 3 and show_day_div, "Tuesday", shape.labeldown, location.top, na, text = "Tuesday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 4 and show_day_div, "Wednesay", shape.labeldown, location.top, na, text = "Wednesday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 5 and show_day_div, "Thursday", shape.labeldown, location.top, na, text = "Thursday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 6 and show_day_div, "Friday", shape.labeldown, location.top, na, text = "Friday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)
plotshape(day != day[1] and day == 7 and show_day_div, "Saturday", shape.labeldown, location.top, na, text = "Saturday", textcolor = color.gray, size = size.tiny, display = display.all - display.status_line, editable = false)

//-----------------------------------------------------------------------------}
