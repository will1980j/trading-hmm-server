<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automated Signals ULTRA</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/automated_signals_ultra.css') }}">
</head>
<body>
    <!-- REGION A: SIGNAL FEED HEADER -->
    <header class="ultra-header">
        <div class="header-main">
            <h1 class="ultra-title">Automated Signals ULTRA</h1>
            <div class="status-pill live">LIVE</div>
        </div>
        
        <div class="header-controls">
            <div class="dataset-selector">
                <button class="dataset-btn active" data-dataset="v1">V1</button>
                <button class="dataset-btn" data-dataset="v2">V2</button>
            </div>
            
            <div class="session-switcher">
                <select id="sessionSelect">
                    <option value="london">London</option>
                    <option value="ny" selected>New York</option>
                    <option value="asia">Asia</option>
                </select>
            </div>
            
            <div class="timestamp" id="liveTimestamp">--:--:--</div>
        </div>
        
        <div class="metrics-row">
            <div class="metric-item">
                <span class="metric-label">Signals Today</span>
                <span class="metric-value" id="signalsToday">0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">Confirmed</span>
                <span class="metric-value" id="confirmedSignals">0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">Active Trades</span>
                <span class="metric-value" id="activeTrades">0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">Avg R</span>
                <span class="metric-value" id="avgR">0.0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">MFE High</span>
                <span class="metric-value" id="mfeHigh">0.0</span>
            </div>
        </div>
    </header>

    <div class="ultra-container">
        <!-- REGION E: LEFT COLLAPSIBLE FILTERS/HISTORY -->
        <aside class="filters-panel" id="filtersPanel">
            <div class="panel-header">
                <h3>Filters & History</h3>
                <button class="collapse-btn" id="collapseFilters">←</button>
            </div>
            
            <div class="filter-section">
                <h4>Filters</h4>
                
                <div class="filter-group">
                    <label>Session</label>
                    <select id="filterSession">
                        <option value="all">All Sessions</option>
                        <option value="london">London</option>
                        <option value="ny">New York</option>
                        <option value="asia">Asia</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Direction</label>
                    <select id="filterDirection">
                        <option value="all">All</option>
                        <option value="long">Long</option>
                        <option value="short">Short</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filterStatus">
                        <option value="all">All</option>
                        <option value="pending">Pending</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="be">Breakeven</option>
                        <option value="mfe">MFE</option>
                        <option value="exit">Exit</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Time Window</label>
                    <select id="filterTime">
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>R Range</label>
                    <input type="range" id="rRangeMin" min="-5" max="5" step="0.1" value="-5">
                    <input type="range" id="rRangeMax" min="-5" max="5" step="0.1" value="5">
                    <div class="range-display">
                        <span id="rRangeDisplay">-5.0 to 5.0</span>
                    </div>
                </div>
                
                <div class="filter-group">
                    <label>MFE Range</label>
                    <input type="range" id="mfeRangeMin" min="0" max="10" step="0.1" value="0">
                    <input type="range" id="mfeRangeMax" min="0" max="10" step="0.1" value="10">
                    <div class="range-display">
                        <span id="mfeRangeDisplay">0.0 to 10.0</span>
                    </div>
                </div>
            </div>
            
            <div class="history-section">
                <h4>History</h4>
                <div class="recent-signals" id="recentSignals">
                    <!-- Recent signals populated by JS -->
                </div>
                <button class="load-older-btn" id="loadOlderBtn">Load Older Signals</button>
            </div>
        </aside>

        <!-- REGION B: LIVE SIGNAL FEED (TERMINAL PANEL) -->
        <main class="signal-feed">
            <div class="feed-header">
                <h2>Live Signal Feed</h2>
                <div class="feed-controls">
                    <button class="auto-scroll-btn active" id="autoScrollBtn">Auto Scroll</button>
                    <button class="clear-feed-btn" id="clearFeedBtn">Clear</button>
                </div>
            </div>
            
            <div class="signal-cards-container" id="signalCardsContainer">
                <!-- Signal cards populated by JS -->
            </div>
        </main>

        <!-- REGION C: SIGNAL DETAILS RIGHT PANEL -->
        <aside class="details-panel" id="detailsPanel">
            <div class="panel-header">
                <h3>Signal Details</h3>
                <button class="close-btn" id="closeDetailsBtn">×</button>
            </div>
            
            <div class="details-content" id="detailsContent">
                <div class="no-selection">
                    <p>Select a signal to view details</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- REGION D: PERFORMANCE STRIP (BOTTOM) -->
    <footer class="performance-strip">
        <div class="perf-metrics">
            <div class="perf-item">
                <span class="perf-label">Today's R</span>
                <span class="perf-value" id="todayR">+0.0</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">Today's P&L</span>
                <span class="perf-value" id="todayPnl">$0.00</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">Session P&L</span>
                <span class="perf-value" id="sessionPnl">$0.00</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">MFE High/Low</span>
                <span class="perf-value" id="mfeHighLow">0.0 / 0.0</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">BE Triggers</span>
                <span class="perf-value" id="beTriggers">0</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">SL Events</span>
                <span class="perf-value" id="slEvents">0</span>
            </div>
        </div>
        
        <div class="sparkline-container">
            <canvas id="sparklineChart" width="200" height="40"></canvas>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/automated_signals_ultra.js') }}"></script>
</body>
</html>
